---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
  name: cloudstacknodeclasses.karpenter.k8s.cloudstack
spec:
  group: karpenter.k8s.cloudstack
  names:
    categories:
    - karpenter
    kind: CloudStackNodeClass
    listKind: CloudStackNodeClassList
    plural: cloudstacknodeclasses
    shortNames:
    - csnc
    - csncs
    singular: cloudstacknodeclass
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.conditions[?(@.type=='Ready')].status
      name: Ready
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    - jsonPath: .spec.zone
      name: Zone
      priority: 1
      type: string
    name: v1
    schema:
      openAPIV3Schema:
        description: CloudStackNodeClass is the Schema for the CloudStackNodeClass
          API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: |-
              CloudStackNodeClassSpec is the top level specification for the CloudStack Karpenter Provider.
              This will contain configuration necessary to launch instances in CloudStack.
            properties:
              diskOffering:
                description: DiskOffering specifies the disk offering for data disks
                type: string
              networkSelectorTerms:
                description: NetworkSelectorTerms is a list of network selector terms.
                  The terms are ORed.
                items:
                  description: |-
                    NetworkSelectorTerm defines selection logic for a network used by Karpenter to launch nodes.
                    If multiple fields are used for selection, the requirements are ANDed.
                  properties:
                    id:
                      description: ID is the network id in CloudStack
                      type: string
                    name:
                      description: Name is the network name in CloudStack
                      type: string
                    tags:
                      additionalProperties:
                        type: string
                      description: |-
                        Tags is a map of key/value tags used to select networks
                        Specifying '*' for a value selects all values for a given tag key.
                      maxProperties: 20
                      type: object
                      x-kubernetes-validations:
                      - message: empty tag keys or values aren't supported
                        rule: self.all(k, k != '' && self[k] != '')
                  type: object
                maxItems: 30
                type: array
                x-kubernetes-validations:
                - message: networkSelectorTerms cannot be empty
                  rule: self.size() != 0
                - message: expected at least one, got none, ['tags', 'id', 'name']
                  rule: self.all(x, has(x.tags) || has(x.id) || has(x.name))
              rootDiskSize:
                description: RootDiskSize specifies the size of the root disk in GB
                format: int64
                maximum: 1000
                minimum: 1
                type: integer
              serviceOfferingSelectorTerms:
                description: ServiceOfferingSelectorTerms is a list of service offering
                  selector terms. The terms are ORed.
                items:
                  description: |-
                    ServiceOfferingSelectorTerm defines selection logic for a service offering used by Karpenter to launch nodes.
                    If multiple fields are used for selection, the requirements are ANDed.
                  properties:
                    id:
                      description: ID is the service offering id in CloudStack
                      type: string
                    name:
                      description: Name is the service offering name in CloudStack
                      type: string
                    tags:
                      additionalProperties:
                        type: string
                      description: |-
                        Tags is a map of key/value tags used to select service offerings
                        Specifying '*' for a value selects all values for a given tag key.
                      maxProperties: 20
                      type: object
                      x-kubernetes-validations:
                      - message: empty tag keys or values aren't supported
                        rule: self.all(k, k != '' && self[k] != '')
                  type: object
                maxItems: 30
                type: array
                x-kubernetes-validations:
                - message: serviceOfferingSelectorTerms cannot be empty
                  rule: self.size() != 0
                - message: expected at least one, got none, ['tags', 'id', 'name']
                  rule: self.all(x, has(x.tags) || has(x.id) || has(x.name))
              sshKeyPair:
                description: SSHKeyPair is the name of the SSH keypair to use for
                  the instances
                type: string
              tags:
                additionalProperties:
                  type: string
                description: Tags to be applied on CloudStack resources like instances.
                type: object
                x-kubernetes-validations:
                - message: empty tag keys aren't supported
                  rule: self.all(k, k != '')
                - message: tag contains a restricted tag matching karpenter.sh/nodepool
                  rule: self.all(k, k != 'karpenter.sh/nodepool')
                - message: tag contains a restricted tag matching karpenter.sh/nodeclaim
                  rule: self.all(k, k !='karpenter.sh/nodeclaim')
                - message: tag contains a restricted tag matching karpenter.k8s.cloudstack/nodeclass
                  rule: self.all(k, k !='karpenter.k8s.cloudstack/nodeclass')
              templateSelectorTerms:
                description: TemplateSelectorTerms is a list of template selector
                  terms. The terms are ORed.
                items:
                  description: |-
                    TemplateSelectorTerm defines selection logic for a template used by Karpenter to launch nodes.
                    If multiple fields are used for selection, the requirements are ANDed.
                  properties:
                    id:
                      description: ID is the template id in CloudStack
                      type: string
                    name:
                      description: Name is the template name in CloudStack
                      type: string
                    osType:
                      description: OSType filters templates by operating system type
                      type: string
                    tags:
                      additionalProperties:
                        type: string
                      description: |-
                        Tags is a map of key/value tags used to select templates
                        Specifying '*' for a value selects all values for a given tag key.
                      maxProperties: 20
                      type: object
                      x-kubernetes-validations:
                      - message: empty tag keys or values aren't supported
                        rule: self.all(k, k != '' && self[k] != '')
                  type: object
                maxItems: 30
                type: array
                x-kubernetes-validations:
                - message: templateSelectorTerms cannot be empty
                  rule: self.size() != 0
                - message: expected at least one, got none, ['tags', 'id', 'name']
                  rule: self.all(x, has(x.tags) || has(x.id) || has(x.name))
              userData:
                description: |-
                  UserData to be applied to the provisioned nodes.
                  It must be in cloud-init format.
                type: string
              zone:
                description: Zone is the CloudStack zone where VMs will be launched
                type: string
            required:
            - networkSelectorTerms
            - serviceOfferingSelectorTerms
            - templateSelectorTerms
            - zone
            type: object
          status:
            description: CloudStackNodeClassStatus contains the resolved state of
              the CloudStackNodeClass
            properties:
              conditions:
                description: Conditions contains signals for health and readiness
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
              networks:
                description: Networks contains the resolved networks
                items:
                  description: Network describes a CloudStack network
                  properties:
                    id:
                      description: ID is the network ID
                      type: string
                    name:
                      description: Name is the network name
                      type: string
                    type:
                      description: Type is the network type (Isolated, Shared, etc.)
                      type: string
                    zone:
                      description: Zone is the zone where this network is available
                      type: string
                  required:
                  - id
                  - name
                  - zone
                  type: object
                type: array
              serviceOfferings:
                description: ServiceOfferings contains the resolved service offerings
                items:
                  description: ServiceOffering describes a CloudStack service offering
                  properties:
                    cpuNumber:
                      description: CPUNumber is the number of CPUs
                      type: integer
                    cpuSpeed:
                      description: CPUSpeed is the CPU speed in MHz
                      type: integer
                    id:
                      description: ID is the service offering ID
                      type: string
                    memory:
                      description: Memory is the memory in MB
                      type: integer
                    name:
                      description: Name is the service offering name
                      type: string
                    networkRate:
                      description: NetworkRate is the network rate in MB/s
                      type: integer
                  required:
                  - cpuNumber
                  - id
                  - memory
                  - name
                  type: object
                type: array
              templates:
                description: Templates contains the resolved templates
                items:
                  description: Template describes a CloudStack template
                  properties:
                    id:
                      description: ID is the template ID
                      type: string
                    name:
                      description: Name is the template name
                      type: string
                    osType:
                      description: OSType is the operating system type
                      type: string
                    zone:
                      description: Zone is the zone where this template is available
                      type: string
                  required:
                  - id
                  - name
                  - zone
                  type: object
                type: array
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
